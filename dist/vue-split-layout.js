(function(d,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],n):(d=typeof globalThis<"u"?globalThis:d||self,n(d.VueSplitLayout={},d.Vue))})(this,function(d,n){"use strict";var L=Object.defineProperty;var A=(d,n,p)=>n in d?L(d,n,{enumerable:!0,configurable:!0,writable:!0,value:p}):d[n]=p;var w=(d,n,p)=>A(d,typeof n!="symbol"?n+"":n,p);const p=(t,i)=>{const s=t.__vccOpts||t;for(const[r,e]of i)s[r]=e;return s},v={name:"Split",props:{resizeable:{type:Boolean,default:!1},dir:{type:String,default:"horizontal"},split:{type:String,default:"50%"}},data(){return{state:{resizing:!1,split:this.split}}},computed:{splitClass(){return["split",this.dir,this.state.resizing?"resizing":"",this.resizeable?"resizeable":""]}},methods:{startResize(t){if(!this.resizeable||t.button!==0)return;t.preventDefault(),this.state.resizing=!0;const i=r=>{const e=this.dir==="horizontal",o=(e?this.$el.children[1].clientWidth:this.$el.children[1].clientHeight)/2,l=this.$el.getBoundingClientRect(),c=e?(r.clientX-l.left-o)/this.$el.clientWidth*100:(r.clientY-l.top-o)/this.$el.clientHeight*100;this.state.split=c+"%"},s=()=>{this.state.resizing=!1,document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",i),document.addEventListener("mouseup",s)}}},$={class:"content"};function _(t,i,s,r,e,o){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(o.splitClass)},[n.createElementVNode("div",{class:"content",style:n.normalizeStyle({"flex-basis":e.state.split})},[n.renderSlot(t.$slots,"first",{},void 0,!0)],4),n.createElementVNode("div",{class:"splitter",onMousedown:i[0]||(i[0]=(...l)=>o.startResize&&o.startResize(...l))},null,32),n.createElementVNode("div",$,[n.renderSlot(t.$slots,"second",{},void 0,!0)])],2)}const u=p(v,[["render",_],["__scopeId","data-v-af012366"]]),f=class f{constructor(i){this.tree=i||[]}push(i){return i.id===void 0&&(i.id=f.gid++),this.tree.push(i),i}findById(i){return this.tree.find(s=>s.id===i)}childrenOf(i){return this.tree.filter(s=>s.parent===i)}attachChild(i,s,r,e){r.id===void 0&&(r.id=f.gid++),e=e||33;const o=this.tree.indexOf(i),l={id:f.gid++,type:"split",parent:i.parent,dir:s%2===0?"vertical":"horizontal"};return i.parent=l,r.parent=l,this.tree[o]=l,s===0||s===3?(l.split=e+"%",this.tree.push(r,i)):(l.split=100-e+"%",this.tree.push(i,r)),r}};w(f,"gid",0);let h=f;h.from=function(t){return new h(t)};const E={name:"Layout",props:{edit:{type:Boolean,default:!0},resize:{type:Boolean,default:!0},splits:{type:[String,Number,Object],default:()=>({})}},data(){return{nodes:this.calcSplits(),drag:null,savedNodes:null}},watch:{splits(){this.nodes=this.calcSplits()}},beforeUpdate(){if(!this.$refs.container)return;const t=this.$refs.container.querySelectorAll("[target-view]");Array.from(t).forEach(i=>{const s=this.$refs.container.querySelector(`[src-view=${i.getAttribute("target-view")}]`);s&&s.children[0]&&s.appendChild(i.children[0])})},methods:{calcSplits(){const t=[],i=h.from(t),s=r=>{if(r instanceof Object){const e=i.push({type:"split",dir:r.dir,split:r.split});return s(r.first).parent=e,s(r.second).parent=e,e}return i.push({type:"view",viewId:r})};return s(this.splits),t},childrenOf(t){return h.from(this.nodes).childrenOf(t)},renderNode(t){return t.type==="split"?u:"div"},onSplitResize(t,i,s){const r=i.props["node-id"],e=h.from(this.nodes).findById(r);e.split=s},previewPane(t,i,s){if(t===-1){this.$refs.preview.style.opacity=0;return}if(!i)return-1;s=s||33;const r=s/100,e=i.getBoundingClientRect(),o={left:e.left,top:e.top,width:e.width,height:e.height};t===1?o.left+=o.width-o.width*r:t===2&&(o.top+=o.height-o.height*r),t%2===0?o.height*=r:o.width*=r,this.$refs.preview.style.opacity=1;for(const l in o)this.$refs.preview.style[l]=`${o[l]}px`},onViewDragStart(t){if(t.button!==0)return;const i=t.target.hasAttribute("node-id"),s=t.target.hasAttribute("pane-drag");if(!i&&!s)return;let r=t.target;if(!i){let a=r;for(;a&&a.matches&&!a.hasAttribute("node-id");)a=a.parentNode;if(!a||!a.matches)return;r=a}const e=parseInt(r.getAttribute("node-id"),10),o=this.nodes.find(a=>a.id===e);if(!o)return;t.preventDefault();const l=this.$refs.container.getBoundingClientRect(),c=t.target.getBoundingClientRect();this.drag={node:o,offset:{x:t.clientX-c.left,y:t.clientY-c.top}},this.savedNodes=structuredClone(this.nodes),h.from(this.nodes).removeChild(o),this.$refs.drag.style.top=`${c.y-l.top}px`,this.$refs.drag.style.left=`${c.x-l.left}px`,this.$refs.drag.style.width=`${c.width}px`,this.$refs.drag.style.height=`${c.height}px`,document.addEventListener("mousemove",this.onViewDrag),document.addEventListener("mouseup",this.onViewDrop)},onViewDrag(t){if(t.button!==0)return;const i=this.$refs.container.getBoundingClientRect(),s={x:t.clientX-i.left,y:t.clientY-i.top};this.$refs.drag.style.left=`${s.x-this.drag.offset.x}px`,this.$refs.drag.style.top=`${s.y-this.drag.offset.y}px`,this.$refs.drag.style.pointerEvents="none";const r=document.elementFromPoint(t.clientX,t.clientY);this.$refs.drag.style.pointerEvents=null;let e=r;for(;e&&!e.matches(".view");)e=e.parentNode;if(!e||!e.matches){this.previewPane(-1);return}const o=this.checkAttach(e,t);o!==-1&&(this.drag.over={viewDom:e,attach:o}),this.previewPane(o,e)},onViewDrop(t){if(t.button!==0)return;if(document.removeEventListener("mousemove",this.onViewDrag),document.removeEventListener("mouseup",this.onViewDrop),this.previewPane(-1),!this.drag.over){this.drag=null,this.nodes=this.savedNodes;return}const{viewDom:i,attach:s}=this.drag.over,r=parseInt(i.getAttribute("node-id"),10),e=h.from(this.nodes),o=e.findById(r);e.attachChild(o,s,this.drag.node),this.drag=null},checkAttach(t,i,s=33){const r=s/100,e=t.getBoundingClientRect(),o=e.width*r,l=e.height*r,c={x:i.clientX-e.left,y:i.clientY-e.top},a=[c.y-l,e.width-o-c.x,e.height-l-c.y,c.x-o];let g=0,m=-1;return a.forEach((y,D)=>{y<g&&(g=y,m=D)}),m}}},S={class:"preview",ref:"preview"},z=["target-view"],B={style:{display:"none"}};function b(t,i,s,r,e,o){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(t.layoutClass),ref:"container"},[n.createElementVNode("div",{class:n.normalizeClass(["views",{dragging:!!e.drag}]),ref:"views"},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(o.childrenOf(e.nodes[0]),l=>(n.openBlock(),n.createBlock(n.resolveDynamicComponent(o.renderNode(l)),{key:l.id}))),128))],2),n.createElementVNode("div",S,null,512),n.createElementVNode("div",{class:n.normalizeClass({drag:!0,dragging:!!e.drag}),ref:"drag"},[e.drag?(n.openBlock(),n.createElementBlock("div",{key:0,class:"view","target-view":"view-"+e.drag.node.viewId},null,8,z)):n.createCommentVNode("",!0)],2),n.createElementVNode("div",B,[n.renderSlot(t.$slots,"default",{},void 0,!0)])],2)}const C=p(E,[["render",b],["__scopeId","data-v-023303c4"]]),k={name:"Pane",props:{title:{type:String,default:""}}},V={class:"pane"},N={class:"header"},x={class:"content"};function I(t,i,s,r,e,o){return n.openBlock(),n.createElementBlock("div",V,[n.createElementVNode("div",N,n.toDisplayString(s.title),1),n.createElementVNode("div",x,[n.renderSlot(t.$slots,"default",{},void 0,!0)])])}const R=p(k,[["render",I],["__scopeId","data-v-2502aea4"]]);d.Layout=C,d.Pane=R,d.Split=u,d.Tree=h,Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=vue-split-layout.js.map
